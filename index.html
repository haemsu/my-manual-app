<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ë§¤ë‰´ì–¼ ì›¹ì•±</title>
<style>
  body { display: flex; height: 100vh; margin: 0; font-family: sans-serif; }
  #sidebar { width: 300px; border-right: 1px solid #ccc; overflow-y: auto; padding: 10px; box-sizing: border-box; }
  #content { flex: 1; padding: 10px; box-sizing: border-box; }
  ul { list-style: none; padding: 0; margin: 0; }
  li { display: flex; align-items: center; justify-content: space-between; padding: 4px 0; }
  .page-name { flex: 1; cursor: pointer; }
  input.edit-name { flex: 1; padding: 2px; font-size: 1em; }
  button { margin-left: 5px; }
  #editor { width: 100%; height: 90vh; }
  #viewer { white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; height: 90vh; overflow-y: auto; background: #f9f9f9; }
</style>
</head>
<body>

<div id="sidebar">
  <button id="addPageBtn">+ ìƒˆ í•­ëª© ì¶”ê°€</button>
  <ul id="pageList"></ul>
</div>

<div id="content">
  <button id="editToggleBtn">ìˆ˜ì • ëª¨ë“œ</button>
  <div id="editor" contenteditable="false" style="display:none; border:1px solid #ccc; padding:10px; height:90vh; overflow-y:auto;"></div>
  <pre id="viewer"></pre>
</div>

<script>
(() => {
  const pageList = document.getElementById('pageList');
  const addPageBtn = document.getElementById('addPageBtn');
  const editToggleBtn = document.getElementById('editToggleBtn');
  const editor = document.getElementById('editor');
  const viewer = document.getElementById('viewer');

  let pages = {};
  let currentKey = null;
  let editMode = false;

  // ì €ì¥ í•¨ìˆ˜ (ì—¬ê¸°ì„œëŠ” ë¡œì»¬ë³€ê²½ ë°˜ì˜ë§Œ, ì‹¤ì œ ì €ì¥ì†Œ ì—°ë™ì€ ë³„ë„ êµ¬í˜„ í•„ìš”)
  function saveData() {
    // ì‹¤ì œ ì €ì¥ì€ GitHub API ë“±ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥
    console.log('ìë™ ì €ì¥:', pages);
  }

  // ìƒˆ í˜ì´ì§€ ëª©ë¡ ë Œë”ë§
  function renderPageList() {
    pageList.innerHTML = '';
    for (const key in pages) {
      const li = document.createElement('li');
      li.dataset.key = key;

      const span = document.createElement('span');
      span.className = 'page-name';
      span.textContent = key;
      span.title = 'ì´ë¦„ í´ë¦­: ì„ íƒ / âœï¸ í¸ì§‘ ì•„ì´ì½˜ í´ë¦­: ì´ë¦„ ìˆ˜ì •';

      // ì„ íƒ ì‹œ ë‚´ìš© í‘œì‹œ
      span.onclick = () => {
        if (editMode) return;
        currentKey = key;
        renderContent();
        highlightSelected();
      };
      li.appendChild(span);

      if (editMode) {
        const editBtn = document.createElement('button');
        editBtn.textContent = 'âœï¸';
        editBtn.title = 'ì´ë¦„ ìˆ˜ì •';
        editBtn.onclick = (e) => {
          e.stopPropagation();
          const input = document.createElement('input');
          input.type = 'text';
          input.value = key;
          input.className = 'edit-name';
          li.replaceChild(input, span);
          input.focus();
          input.select();

          input.onblur = () => {
            const newName = input.value.trim();
            if (!newName) {
              alert('ì´ë¦„ì€ ë¹„ìš¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              input.focus();
              return;
            }
            if (newName !== key) {
              if (pages[newName]) {
                alert('ê°™ì€ ì´ë¦„ì˜ í•­ëª©ì´ ì´ë¯¸ ìˆìŠµë‹ˆë‹¤.');
                input.focus();
                return;
              }
              pages[newName] = pages[key];
              delete pages[key];
              if (currentKey === key) currentKey = newName;
              renderPageList();
              saveData();
            } else {
              li.replaceChild(span, input);
            }
          };
          input.onkeydown = (evt) => {
            if (evt.key === 'Enter') {
              input.blur();
            }
          };
        };
        li.appendChild(editBtn);

        const delBtn = document.createElement('button');
        delBtn.textContent = 'ğŸ—‘ï¸';
        delBtn.title = 'ì‚­ì œ';
        delBtn.onclick = (e) => {
          e.stopPropagation();
          if (confirm(`'${key}' í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            delete pages[key];
            if (currentKey === key) {
              currentKey = null;
              editor.style.display = 'none';
              viewer.textContent = '';
            }
            renderPageList();
            saveData();
          }
        };
        li.appendChild(delBtn);
      }

      pageList.appendChild(li);
    }
    highlightSelected();
  }

  // ì„ íƒëœ í•­ëª© ê°•ì¡°
  function highlightSelected() {
    [...pageList.children].forEach(li => {
      li.style.backgroundColor = li.dataset.key === currentKey ? '#d0e7ff' : '';
    });
  }

  // ë‚´ìš© ë Œë”ë§ (ë³´ê¸° ëª¨ë“œ)
  function renderContent() {
    if (!currentKey) {
      editor.style.display = 'none';
      viewer.textContent = '';
      return;
    }
    viewer.textContent = pages[currentKey] || '';
    viewer.style.display = editMode ? 'none' : 'block';
    editor.style.display = editMode ? 'block' : 'none';
    editor.textContent = pages[currentKey] || '';
  }

  // ìˆ˜ì • ëª¨ë“œ í† ê¸€
  editToggleBtn.onclick = () => {
    if (!currentKey) {
      alert('ë¨¼ì € í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”.');
      return;
    }
    editMode = !editMode;
    editToggleBtn.textContent = editMode ? 'ë³´ê¸° ëª¨ë“œ' : 'ìˆ˜ì • ëª¨ë“œ';
    renderContent();
    renderPageList();
  };

  // ìƒˆ í•­ëª© ì¶”ê°€
  addPageBtn.onclick = () => {
    let newName = prompt('ìƒˆ í•­ëª© ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.');
    if (!newName) return;
    newName = newName.trim();
    if (!newName) return alert('ì´ë¦„ì€ ë¹„ì›Œë‘˜ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    if (pages[newName]) return alert('ê°™ì€ ì´ë¦„ì˜ í•­ëª©ì´ ì´ë¯¸ ìˆìŠµë‹ˆë‹¤.');
    pages[newName] = '';
    currentKey = newName;
    renderPageList();
    renderContent();
    saveData();
    if (!editMode) {
      editToggleBtn.click();
    }
  };

  // ì—ë””í„° ë‚´ìš© ë³€ê²½ì‹œ ìë™ ì €ì¥ (debounce ì—†ì´ ê°„ë‹¨ êµ¬í˜„)
  editor.addEventListener('input', () => {
    if (!editMode || !currentKey) return;
    pages[currentKey] = editor.textContent;
    saveData();
  });

  // ì´ˆê¸° ë°ì´í„° ìƒ˜í”Œ
  pages = {
    "ì˜ˆì‹œ í•­ëª© 1": "ì—¬ê¸°ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.",
    "ì˜ˆì‹œ í•­ëª© 2": "ë‘ë²ˆì§¸ í•­ëª© ë‚´ìš©ì…ë‹ˆë‹¤."
  };
  currentKey = Object.keys(pages)[0];

  renderPageList();
  renderContent();
})();
</script>

</body>
</html>
